(()=>{var m=class extends HTMLElement{constructor(){super(),this.store=window.themeStore,this.keys=window.themeKeys,this.defaults={light:this.dataset.light,dark:this.dataset.dark},this.setTheme(this.getTheme()),this.addEventListener("click",this),this.addEventListener("change",this),document.addEventListener("keyup",this),this.styleStore="cknCustom",this.customSheet=new CSSStyleSheet}getPreferredScheme(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}getPreferredMotion(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches?"reduce":"no-preference"}hexToRgb(e){e=e.trim(),e.startsWith("#")===!1&&(e=`#${e};`);let t=0,s=0,o=0;return e.length===4?(t="0x"+e[1]+e[1],s="0x"+e[2]+e[2],o="0x"+e[3]+e[3]):e.length===7&&(t="0x"+e[1]+e[2],s="0x"+e[3]+e[4],o="0x"+e[5]+e[6]),{r:t,g:s,b:o}}rgbToHsl({r:e,g:t,b:s}){e/=255,t/=255,s/=255;let o=Math.min(e,t,s),r=Math.max(e,t,s),a=r-o,i=0,n=0,c=0;return a===0?i=0:r===e?i=(t-s)/a%6:r===t?i=(s-e)/a+2:i=(e-t)/a+4,i=Math.round(i*60),i<0&&(i+=360),c=(r+o)/2,n=a==0?0:a/(1-Math.abs(2*c-1)),n=+(n*100).toFixed(1),c=+(c*100).toFixed(1),{h:i,s:n,l:c}}hexToHsl(e){return this.rgbToHsl(this.hexToRgb(e))}setTheme(e){(!e||this.keys.includes(e)===!1)&&(e=""),document.documentElement.style.setProperty("--anim-f","0"),e?(document.documentElement.setAttribute("data-theme",e),localStorage.setItem(this.store,e)):(document.documentElement.removeAttribute("data-theme"),localStorage.removeItem(this.store)),requestAnimationFrame(()=>{setTimeout(()=>document.documentElement.style.removeProperty("--anim-f"))}),document.querySelectorAll("[data-theme-set]").forEach(function(t){t.setAttribute("aria-pressed",(t.getAttribute("data-theme-set")===e).toString())})}getTheme(){let e=localStorage.getItem(this.store);if(!e)return!1;if(this.keys.includes(e)===!1){let t=this.getPreferredScheme();return this.defaults[t]}return e}updateCustomThemeStyles(){let e=document.getElementById("theme-custom-form"),t=Object.fromEntries(new FormData(e)),s=this.hexToHsl(t["C-canvas"]),o=this.hexToHsl(t["C-accent"]),r=s.l<50,a=Object.entries(t).map(([d,h])=>{let l;switch(d){case"font-heading-family":{l={Canela:"Canela, serif",XanhMono:"XanhMono, monospace",InstrumentSerif:"InstrumentSerif, serif",Chinook:"Chinook, Cooper Black, serif",didone:"Didot, Bodoni MT, Noto Serif Display, URW Palladio L, P052, Sylfaen, serif",Switzer:"Switzer, sans-serif",MDNichrome:"MDNichrome, sans-serif",Rajdhani:"Rajdhani, sans-serif",TeXGyreAdventor:"TeXGyreAdventor, ITC Avant Garde, sans-serif",LibreFranklin:"LibreFranklin, Libre Franklin, Franklin Gothic, HEX Franklin, sans-serif",Outfit:"Outfit, Century Gothic, sans-serif",times:"Times New Roman, Times",comicsans:"Comic Sans MS, casual, cursive",humanist:"Optima, Candara, Noto Sans, source-sans-pro, sans-serif"}[h]||"sans-serif";break}case"font-body-family":{l=`var(--fontStack-${h})`;break}case"corner":{l=h==="round"?"4px":"0px";break}case"anim-f":{l=h==="reduce"?"0":"1";break}default:l=h}return`--${d}: ${l};`}),i=s.l<5||s.l>=95?0:Math.round(Math.pow((o.s-s.s)/100,2)*100),n=Math.min(67,Math.round(Math.pow(1-s.l/100,2)*100)),c=`${o.h}deg ${i}% ${n}%`;this.customSheet.replaceSync(`:root[data-theme="custom"] {
			--color-scheme: ${r?"dark":"light"};
			${a.join(`
			`)}
			--font-heading-style: ${t["font-heading-family"]==="XanhMono"?"italic":"normal"};
			--font-heading-size-adjust: none;
			${t["font-heading-transform"]==="uppercase"?"--HERO-title-factor: 1.75;":""}
			--header-bg-color: color-mix(in oklch, var(--C-surface), var(--C-canvas));
			--stroke-linecap: ${t.corner};
			--shadow-color: ${c};
			${t["font-body-family"]==="monospace"?"font-size-adjust: 0.45;":""}
		}`),document.adoptedStyleSheets=[this.customSheet],window.localStorage.setItem(this.styleStore,JSON.stringify(t))}connectedCallback(){let e=JSON.parse(window.localStorage.getItem(this.styleStore)||null),t=document.getElementById("theme-custom-form");if(e)Array.from(t.querySelectorAll("[name]")).forEach(s=>{let o=s.getAttribute("name"),r=s.getAttribute("type")||s.tagName.toLowerCase(),a=e[o];r==="radio"?s.checked=s.value===a:r==="select"?s.value=s.querySelector(`option[value="${a}"]`)?a:s.querySelector("option[data-default]").value:s.value=a});else{let o=this.getPreferredScheme()==="dark",r={canvas:o?"#001111":"#eeffff",surface:o?"#003333":"#cceeee",text:o?"#ffffff":"#000000",heading:o?"#ddffff":"#003333",accent:o?"#33ffff":"#550000"};Array.from(t.querySelectorAll('input[type="color"][data-color-key]')).forEach(a=>{a.value=r[a.getAttribute("data-color-key")]}),Array.from(t.querySelectorAll("[data-default]")).forEach(a=>{let i=a.closest("select"),n=a.closest('input[type="radio"]');i?i.value=a.value:n&&(n.getAttribute("data-default")==="from-media"?a.name==="anim-f"&&(n.checked=this.getPreferredMotion()===n.value):n.checked=!0)})}this.updateCustomThemeStyles()}handleEvent(e){if(e.type==="click"){let t=document.getElementById("theme-custom-controls"),s=e.target===t,o=e.target.closest("[data-theme-custom-action]"),r=e.target.closest("[data-theme-set]");if(o||s){let a=o&&o.getAttribute("data-theme-custom-action");a==="apply"||s?(this.updateCustomThemeStyles(),t.close()):a==="open"&&(t.showModal(),this.updateCustomThemeStyles(),this.setTheme("custom"))}else if(r){let a=r.getAttribute("aria-pressed")==="true";this.setTheme(a?!1:r.getAttribute("data-theme-set"))}}if(e.type==="keyup"){if(e.key==="Escape"){let t=document.querySelector(`[aria-controls=${this.id}]`);t&&t.getAttribute("aria-pressed")==="true"&&(t.setAttribute("aria-pressed","false"),t.focus())}else if(e.key>=0&&e.key<=this.keys.length&&!e.target?.closest?.("input")){let t=parseInt(e.key,10);this.querySelectorAll("[data-theme-set]")[t]?.click()}}e.type==="change"&&this.updateCustomThemeStyles()}};customElements.define("theme-picker",m);})();

(()=>{var x=Object.defineProperty;var H=(t,r,s)=>r in t?x(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s;var q=(t,r,s)=>H(t,typeof r!="symbol"?r+"":r,s);function h(t){return t.replace(/(‘|’)/,"'")}function v(t){switch(t){case"*":return"All";case"_fonts":return"Typeface";case"_designs":return"Design";case"_projects":return"Project";case"_pages":return"Page";case"_posts":default:return"Blogpost"}}var m=class extends HTMLElement{constructor(){super();q(this,"hasRunOnce",!1);this.database=fetch("/search.json").then(s=>s.json()),this.lastSearch=""}connectedCallback(){let s=this.dataset.searchInput,b=this.querySelector("form"),d=this.querySelector(`[name="${s}"]`),c=this.querySelector("[data-results-list]"),A=this.querySelector("template"),g=this.querySelector("[data-results-count]"),u=this.querySelector("[data-results-filter]"),w=async()=>this.database,E=async()=>{let e=h(d.value.toLowerCase().trim());if(e.length<1){d.setCustomValidity("Please provide a non-blank search string."),b.reportValidity();return}switch(d.setCustomValidity(""),e){case"11ty":e="eleventy";break;case"javascript":e="js";break}if(this.lastSearch===e)return;this.hasRunOnce||this.firstRunCallback(),c.innerHTML='<tr><td colspan="3">Loading\u2026</td></tr>',u.innerHTML='<option value="*">All</option>';let a=(await w()).filter(l=>h(l.title.toLowerCase()).includes(e)||h(l.summary.toLowerCase()).includes(e)||h(l.tags.join(" ").toLowerCase()).includes(e));this.lastSearch=e,setTimeout(()=>{if(u.disabled=a.length===0,a.length===0){g.innerText="(0)",c.innerHTML='<tr><td colspan="3">No results found \u{1F622}</td></tr>';return}let l=new DocumentFragment;c.innerHTML="";let T=new Set;a.forEach(n=>{let o=n.type,i=A.content.cloneNode(!0),C=i.querySelector("[data-result-type]"),j=i.querySelector('[data-result-slot="type"]'),y=i.querySelector('[data-result-slot="date"]'),f=i.querySelector('[data-result-slot="link"]'),S=i.querySelector('[data-result-slot="lang"]'),L=new Date(n.date).toISOString().split("T").shift(),k=v(o);T.add(o),C.setAttribute("data-result-type",o),j.innerText=`${k}`,f.setAttribute("href",n.url),f.setAttribute("hreflang",n.lang),f.innerHTML=n.title,["_posts","_designs"].includes(o)?(y.setAttribute("datetime",L),y.innerText=L):y.parentElement.innerHTML="",n.lang!=="en"?S.innerText=`(${n.lang})`:S.hidden=!0,l.append(i)}),g.innerText=`(${a.length})`,c.append(l),Array.from(T).sort().forEach(n=>{let o=Object.assign(document.createElement("option"),{value:n,innerText:v(n)});u.appendChild(o)})},100)};d.addEventListener("blur",function(e){E()}),b.addEventListener("submit",function(e){return e.preventDefault(),E(),!1}),u.addEventListener("change",function(e){let p=u.value||"*";Array.from(c.querySelectorAll("[data-result-type]")).forEach(a=>{a.hidden=p!=="*"&&a.getAttribute("data-result-type")!==p})})}firstRunCallback(){Array.from(this.querySelectorAll("[data-show-on-first-run]")).forEach(s=>{s.hidden=!1}),this.hasRunOnce=!0}};customElements.define("instant-search",m);})();

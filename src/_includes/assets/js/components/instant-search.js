(()=>{var H=Object.defineProperty;var I=(e,r,t)=>r in e?H(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var b=(e,r,t)=>I(e,typeof r!="symbol"?r+"":r,t);function d(e){return e.replace(/(‘|’)/,"'")}function L(e){switch(e){case"*":return"All";case"_fonts":return"Typeface";case"_designs":return"Design";case"_projects":return"Project";case"_pages":return"Page";case"_posts":default:return"Blogpost"}}var p=class extends HTMLElement{constructor(){super();b(this,"hasRunOnce",!1);this.database=fetch("/search.json").then(t=>t.json())}connectedCallback(){let t=this.dataset.searchInput,S=this.querySelector("form"),q=this.querySelector(`[name="${t}"]`),i=this.querySelector("[data-results-list]"),A=this.querySelector("template"),m=this.querySelector("[data-results-count]"),u=this.querySelector("[data-results-filter]"),v=async()=>this.database,w=async()=>{let s=d(q.value.toLowerCase().trim());if(s.length<1)return;switch(s){case"11ty":s="eleventy";break;case"javascript":s="js";break}this.hasRunOnce||this.firstRunCallback(),i.innerHTML="<li>Loading\u2026</li>",u.innerHTML='<option value="*">All</option>';let a=(await v()).filter(l=>d(l.title.toLowerCase()).includes(s)||d(l.summary.toLowerCase()).includes(s)||d(l.tags.join(" ").toLowerCase()).includes(s));setTimeout(()=>{if(u.disabled=a.length===0,a.length===0){m.innerText="(0)",i.innerHTML="<li>No results found \u{1F622}</li>";return}let l=new DocumentFragment;i.innerHTML="";let g=new Set;a.forEach(n=>{let o=n.type,c=A.content.cloneNode(!0),C=c.querySelector("[data-result-type]"),j=c.querySelector('[data-result-slot="type"]'),y=c.querySelector('[data-result-slot="date"]'),f=c.querySelector('[data-result-slot="link"]'),T=c.querySelector('[data-result-slot="lang"]'),E=new Date(n.date).toISOString().split("T").shift(),x=L(o);g.add(o),C.setAttribute("data-result-type",o),j.innerText=`${x}`,f.setAttribute("href",n.url),f.setAttribute("hreflang",n.lang),f.innerHTML=n.title,["_posts","_designs"].includes(o)?(y.setAttribute("datetime",E),y.innerText=E):(console.log(),y.parentElement.innerHTML=""),n.lang!=="en"?T.innerText=`(${n.lang})`:T.hidden=!0,l.append(c)}),m.innerText=`(${a.length})`,i.append(l),Array.from(g).sort().forEach(n=>{let o=Object.assign(document.createElement("option"),{value:n,innerText:L(n)});u.appendChild(o)})},100)};S.addEventListener("submit",function(s){return s.preventDefault(),w(),!1}),u.addEventListener("change",function(s){let h=u.value||"*";Array.from(i.querySelectorAll("[data-result-type]")).forEach(a=>{a.hidden=h!=="*"&&a.getAttribute("data-result-type")!==h})})}firstRunCallback(){Array.from(this.querySelectorAll("[data-show-on-first-run]")).forEach(t=>{t.hidden=!1}),this.hasRunOnce=!0}};customElements.define("instant-search",p);})();

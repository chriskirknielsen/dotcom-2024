(()=>{var H=Object.defineProperty;var I=(t,r,n)=>r in t?H(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;var S=(t,r,n)=>I(t,typeof r!="symbol"?r+"":r,n);function d(t){return t.replace(/(‘|’)/,"'")}function q(t){switch(t){case"*":return"All";case"_fonts":return"Typeface";case"_designs":return"Design";case"_projects":return"Project";case"_pages":return"Page";case"_posts":default:return"Blogpost"}}var y=class extends HTMLElement{constructor(){super();S(this,"hasRunOnce",!1);this.database=fetch("/search.json").then(n=>n.json())}connectedCallback(){let n=this.dataset.searchInput,A=this.querySelector("form"),m=this.querySelector(`[name="${n}"]`),u=this.querySelector("[data-results-list]"),v=this.querySelector("template"),g=this.querySelector("[data-results-count]"),i=this.querySelector("[data-results-filter]"),w=async()=>this.database,E=async()=>{let e=d(m.value.toLowerCase().trim());if(e.length<1)return;switch(e){case"11ty":e="eleventy";break;case"javascript":e="js";break}this.hasRunOnce||this.firstRunCallback(),u.innerHTML='<tr><td colspan="3">Loading\u2026</td></tr>',i.innerHTML='<option value="*">All</option>';let a=(await w()).filter(l=>d(l.title.toLowerCase()).includes(e)||d(l.summary.toLowerCase()).includes(e)||d(l.tags.join(" ").toLowerCase()).includes(e));setTimeout(()=>{if(i.disabled=a.length===0,a.length===0){g.innerText="(0)",u.innerHTML='<tr><td colspan="3">No results found \u{1F622}</td></tr>';return}let l=new DocumentFragment;u.innerHTML="";let T=new Set;a.forEach(s=>{let o=s.type,c=v.content.cloneNode(!0),C=c.querySelector("[data-result-type]"),j=c.querySelector('[data-result-slot="type"]'),p=c.querySelector('[data-result-slot="date"]'),f=c.querySelector('[data-result-slot="link"]'),b=c.querySelector('[data-result-slot="lang"]'),L=new Date(s.date).toISOString().split("T").shift(),x=q(o);T.add(o),C.setAttribute("data-result-type",o),j.innerText=`${x}`,f.setAttribute("href",s.url),f.setAttribute("hreflang",s.lang),f.innerHTML=s.title,["_posts","_designs"].includes(o)?(p.setAttribute("datetime",L),p.innerText=L):(console.log(),p.parentElement.innerHTML=""),s.lang!=="en"?b.innerText=`(${s.lang})`:b.hidden=!0,l.append(c)}),g.innerText=`(${a.length})`,u.append(l),Array.from(T).sort().forEach(s=>{let o=Object.assign(document.createElement("option"),{value:s,innerText:q(s)});i.appendChild(o)})},100)};m.addEventListener("blur",function(e){E()}),A.addEventListener("submit",function(e){return e.preventDefault(),E(),!1}),i.addEventListener("change",function(e){let h=i.value||"*";Array.from(u.querySelectorAll("[data-result-type]")).forEach(a=>{a.hidden=h!=="*"&&a.getAttribute("data-result-type")!==h})})}firstRunCallback(){Array.from(this.querySelectorAll("[data-show-on-first-run]")).forEach(n=>{n.hidden=!1}),this.hasRunOnce=!0}};customElements.define("instant-search",y);})();

(()=>{var H=Object.defineProperty;var I=(e,r,t)=>r in e?H(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var b=(e,r,t)=>I(e,typeof r!="symbol"?r+"":r,t);function d(e){return e.replace(/(‘|’)/,"'")}function L(e){switch(e){case"*":return"All";case"_fonts":return"Typeface";case"_designs":return"Design";case"_projects":return"Project";case"_pages":return"Page";case"_posts":default:return"Blogpost"}}var f=class extends HTMLElement{constructor(){super();b(this,"hasRunOnce",!1);this.database=fetch("/search.json").then(t=>t.json())}connectedCallback(){let t=this.dataset.searchInput,S=this.querySelector("form"),q=this.querySelector(`[name="${t}"]`),u=this.querySelector("[data-results-list]"),A=this.querySelector("template"),m=this.querySelector("[data-results-count]"),i=this.querySelector("[data-results-filter]"),v=async()=>this.database,w=async()=>{let s=d(q.value.toLowerCase().trim());if(s.length<1)return;switch(s){case"11ty":s="eleventy";break;case"javascript":s="js";break}this.hasRunOnce||this.firstRunCallback(),u.innerHTML='<tr><td colspan="3">Loading\u2026</td></tr>',i.innerHTML='<option value="*">All</option>';let a=(await v()).filter(l=>d(l.title.toLowerCase()).includes(s)||d(l.summary.toLowerCase()).includes(s)||d(l.tags.join(" ").toLowerCase()).includes(s));setTimeout(()=>{if(i.disabled=a.length===0,a.length===0){m.innerText="(0)",u.innerHTML='<tr><td colspan="3">No results found \u{1F622}</td></tr>';return}let l=new DocumentFragment;u.innerHTML="";let g=new Set;a.forEach(n=>{let o=n.type,c=A.content.cloneNode(!0),C=c.querySelector("[data-result-type]"),j=c.querySelector('[data-result-slot="type"]'),p=c.querySelector('[data-result-slot="date"]'),y=c.querySelector('[data-result-slot="link"]'),T=c.querySelector('[data-result-slot="lang"]'),E=new Date(n.date).toISOString().split("T").shift(),x=L(o);g.add(o),C.setAttribute("data-result-type",o),j.innerText=`${x}`,y.setAttribute("href",n.url),y.setAttribute("hreflang",n.lang),y.innerHTML=n.title,["_posts","_designs"].includes(o)?(p.setAttribute("datetime",E),p.innerText=E):(console.log(),p.parentElement.innerHTML=""),n.lang!=="en"?T.innerText=`(${n.lang})`:T.hidden=!0,l.append(c)}),m.innerText=`(${a.length})`,u.append(l),Array.from(g).sort().forEach(n=>{let o=Object.assign(document.createElement("option"),{value:n,innerText:L(n)});i.appendChild(o)})},100)};S.addEventListener("submit",function(s){return s.preventDefault(),w(),!1}),i.addEventListener("change",function(s){let h=i.value||"*";Array.from(u.querySelectorAll("[data-result-type]")).forEach(a=>{a.hidden=h!=="*"&&a.getAttribute("data-result-type")!==h})})}firstRunCallback(){Array.from(this.querySelectorAll("[data-show-on-first-run]")).forEach(t=>{t.hidden=!1}),this.hasRunOnce=!0}};customElements.define("instant-search",f);})();
